<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="js," />










<meta name="description" content="前言通过上节 自建vue组件 air-ui (9) -- 用 vuepress 写文档 已经会写 button 标签的文档了。 并且写了 7 个例子用来描述 button 和 button-group 的属性，所以最后的 Button.md 的代码如下:  还是很详细的，具体文档效果上一节的最后有 gif 截图显示。 接下来我们继续写其他已完成组件的文档。 内置服务组件的文档怎么写？？那么问题来了">
<meta name="keywords" content="js">
<meta property="og:type" content="article">
<meta property="og:title" content="自建vue组件 air-ui (10) -- vuepress 写文档 (进阶版)">
<meta property="og:url" content="http://kebingzao.com/2019/12/26/air-ui-10/index.html">
<meta property="og:site_name" content="Zach Ke&#39;s Notes">
<meta property="og:description" content="前言通过上节 自建vue组件 air-ui (9) -- 用 vuepress 写文档 已经会写 button 标签的文档了。 并且写了 7 个例子用来描述 button 和 button-group 的属性，所以最后的 Button.md 的代码如下:  还是很详细的，具体文档效果上一节的最后有 gif 截图显示。 接下来我们继续写其他已完成组件的文档。 内置服务组件的文档怎么写？？那么问题来了">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://kebingzao.com/2019/12/26/air-ui-10/1.gif">
<meta property="og:image" content="http://kebingzao.com/2019/12/26/air-ui-10/1.png">
<meta property="og:image" content="http://kebingzao.com/2019/12/26/air-ui-10/2.png">
<meta property="og:image" content="http://kebingzao.com/2019/12/26/air-ui-10/2.gif">
<meta property="og:image" content="http://kebingzao.com/2019/12/26/air-ui-10/3.png">
<meta property="og:image" content="http://kebingzao.com/2019/12/26/air-ui-10/4.png">
<meta property="og:image" content="http://kebingzao.com/2019/12/26/air-ui-10/5.png">
<meta property="og:image" content="http://kebingzao.com/2019/12/26/air-ui-10/3.gif">
<meta property="og:image" content="http://kebingzao.com/2019/12/26/air-ui-10/6.png">
<meta property="og:image" content="http://kebingzao.com/2019/12/26/air-ui-10/7.png">
<meta property="og:image" content="http://kebingzao.com/2019/12/26/air-ui-10/8.png">
<meta property="og:image" content="http://kebingzao.com/2019/12/26/air-ui-10/9.png">
<meta property="og:image" content="http://kebingzao.com/2019/12/26/air-ui-10/10.png">
<meta property="og:image" content="http://kebingzao.com/2019/12/26/air-ui-10/11.png">
<meta property="og:image" content="http://kebingzao.com/2019/12/26/air-ui-10/12.png">
<meta property="og:image" content="http://kebingzao.com/2019/12/26/air-ui-10/4.gif">
<meta property="og:updated_time" content="2020-01-19T13:31:29.009Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="自建vue组件 air-ui (10) -- vuepress 写文档 (进阶版)">
<meta name="twitter:description" content="前言通过上节 自建vue组件 air-ui (9) -- 用 vuepress 写文档 已经会写 button 标签的文档了。 并且写了 7 个例子用来描述 button 和 button-group 的属性，所以最后的 Button.md 的代码如下:  还是很详细的，具体文档效果上一节的最后有 gif 截图显示。 接下来我们继续写其他已完成组件的文档。 内置服务组件的文档怎么写？？那么问题来了">
<meta name="twitter:image" content="http://kebingzao.com/2019/12/26/air-ui-10/1.gif">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: 'KGVI6VPIBI',
      apiKey: '41c2ccc830ca183768a6bf1e50a03f44',
      indexName: 'test_blog',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://kebingzao.com/2019/12/26/air-ui-10/"/>





  <title>自建vue组件 air-ui (10) -- vuepress 写文档 (进阶版) | Zach Ke's Notes</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Zach Ke's Notes</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Quick notes</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  
  <div class="algolia-popup popup search-popup">
    <div class="algolia-search">
      <div class="algolia-search-input-icon">
        <i class="fa fa-search"></i>
      </div>
      <div class="algolia-search-input" id="algolia-search-input"></div>
    </div>

    <div class="algolia-results">
      <div id="algolia-stats"></div>
      <div id="algolia-hits"></div>
      <div id="algolia-pagination" class="algolia-pagination"></div>
    </div>

    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
  </div>




    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kebingzao.com/2019/12/26/air-ui-10/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zach Ke">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zach Ke's Notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">自建vue组件 air-ui (10) -- vuepress 写文档 (进阶版)</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-12-26T13:46:21+08:00">
                2019-12-26
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/前端相关/" itemprop="url" rel="index">
                    <span itemprop="name">前端相关</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/前端相关/自建vue组件-air-ui/" itemprop="url" rel="index">
                    <span itemprop="name">自建vue组件 air-ui</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/12/26/air-ui-10/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2019/12/26/air-ui-10/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2019/12/26/air-ui-10/" class="leancloud_visitors" data-flag-title="自建vue组件 air-ui (10) -- vuepress 写文档 (进阶版)">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>通过上节 <a href="/2019/12/22/air-ui-9/" title="自建vue组件 air-ui (9) -- 用 vuepress 写文档">自建vue组件 air-ui (9) -- 用 vuepress 写文档</a> 已经会写 <code>button</code> 标签的文档了。 并且写了 7 个例子用来描述 <code>button</code> 和 <code>button-group</code> 的属性，所以最后的 <code>Button.md</code> 的代码如下:</p>
<p><img src="/2019/12/26/air-ui-10/1.gif" alt="1"></p>
<p>还是很详细的，具体文档效果上一节的最后有 gif 截图显示。 接下来我们继续写其他已完成组件的文档。</p>
<h2 id="内置服务组件的文档怎么写？？"><a href="#内置服务组件的文档怎么写？？" class="headerlink" title="内置服务组件的文档怎么写？？"></a>内置服务组件的文档怎么写？？</h2><p>那么问题来了，对于标签组件的文档，我们还可以当做局部组件来引入。那么这种内部服务组件呢，或者指令类型的组件？？ 要怎么引入？？ 毕竟在 <code>vuepress</code> 环境下，可没有像 <code>air-ui</code> 项目那样，可以在 <code>main.js</code> 对组件库进行全局注册？？ 那么怎么找到 <code>vuepress</code> 的 vue 对象呢 ？？<br><a id="more"></a><br>如果你直接在 <code>vuepress</code> demo 里面这样写：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.$notify(&#123;</span><br><span class="line">  title: <span class="string">'警告'</span>,</span><br><span class="line">  message: <span class="string">'这是一条警告的提示消息'</span>,</span><br><span class="line">  type: <span class="string">'warning'</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>编译的时候会提示 <code>this.$notify is not a function</code>, 因为 <code>vuepress</code> 框架的 vue 原型对象根本就没有 <code>$notify</code> 这个方法。</p>
<h2 id="vuepress-应用级别的配置-enhanceApp-js"><a href="#vuepress-应用级别的配置-enhanceApp-js" class="headerlink" title="vuepress 应用级别的配置 enhanceApp.js"></a>vuepress 应用级别的配置 enhanceApp.js</h2><p>后面查了一下，发现 <code>vuepress</code> 也可以<a href="https://vuepress.vuejs.org/zh/guide/basic-config.html#%E5%BA%94%E7%94%A8%E7%BA%A7%E5%88%AB%E7%9A%84%E9%85%8D%E7%BD%AE" target="_blank" rel="noopener">配置应用级别</a>的，包括各种插件。</p>
<p>由于 <code>VuePress</code> 是一个标准的 Vue 应用，我们可以通过创建一个 <code>.vuepress/enhanceApp.js</code> 文件来做一些应用级别的配置，当该文件存在的时候，会被导入到应用内部。<code>enhanceApp.js</code> 应该 <code>export default</code> 一个钩子函数，并接受一个包含了一些应用级别属性的对象作为参数。你可以使用这个钩子来安装一些附加的 Vue 插件、注册全局组件，或者增加额外的路由钩子等：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (&#123;</span><br><span class="line">  Vue, <span class="comment">// VuePress 正在使用的 Vue 构造函数</span></span><br><span class="line">  options, <span class="comment">// 附加到根实例的一些选项</span></span><br><span class="line">  router, <span class="comment">// 当前应用的路由实例</span></span><br><span class="line">  siteData <span class="comment">// 站点元数据</span></span><br><span class="line">&#125;) =&gt; &#123;</span><br><span class="line">  <span class="comment">// ...做一些其他的应用级别的优化</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>一个例子就是：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 扩展 VuePress 应用</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">import</span> VueHighlightJS <span class="keyword">from</span> <span class="string">'vue-highlight.js'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'highlight.js/styles/atom-one-dark.css'</span>;</span><br><span class="line"><span class="keyword">import</span> Element <span class="keyword">from</span> <span class="string">'element-ui'</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'element-ui/lib/theme-chalk/index.css'</span></span><br><span class="line"><span class="keyword">import</span> VueECharts <span class="keyword">from</span> <span class="string">'vue-echarts'</span> <span class="comment">//注册图表</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> <span class="string">'./public/css/index.css'</span> <span class="comment">//组件css文件</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (&#123;</span><br><span class="line"> Vue, <span class="comment">// VuePress 正在使用的 Vue 构造函数</span></span><br><span class="line"> options, <span class="comment">// 附加到根实例的一些选项</span></span><br><span class="line"> router, <span class="comment">// 当前应用的路由实例</span></span><br><span class="line"> siteData <span class="comment">// 站点元数据</span></span><br><span class="line">&#125;) =&gt; &#123;</span><br><span class="line"> <span class="comment">// ...做一些其他的应用级别的优化</span></span><br><span class="line"> Vue.use(VueHighlightJS)</span><br><span class="line"> Vue.use(Element)</span><br><span class="line"> Vue.component(<span class="string">'chart'</span>, VueECharts)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>我后面用 <code>element-ui</code> 试了一下，发现确实是 ok，可以直接在 demo 里面随意使用 <code>element-ui</code> 的组件，而不用局部申明。</p>
<h2 id="接入-enhanceApp-js"><a href="#接入-enhanceApp-js" class="headerlink" title="接入 enhanceApp.js"></a>接入 enhanceApp.js</h2><p>仿照之前接入 <code>element-ui</code> 的写法，创建 <code>.vuepress/enhanceApp.js</code>,并写入:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> DemoBlock <span class="keyword">from</span> <span class="string">'../../src/components/demo-block'</span></span><br><span class="line"><span class="keyword">import</span> AirUI <span class="keyword">from</span> <span class="string">'../../src/components/index'</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'../../src/styles/index.scss'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (&#123;</span><br><span class="line">    Vue, <span class="comment">// VuePress 正在使用的 Vue 构造函数</span></span><br><span class="line">  &#125;) =&gt; &#123;</span><br><span class="line">  <span class="comment">// ...做一些其他的应用级别的优化</span></span><br><span class="line">  Vue.use(DemoBlock);</span><br><span class="line">  Vue.use(AirUI);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>然后将 <code>button</code> 的那些 demo 的引用全部去掉，比如 <code>button/demo-base.vue</code>:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    name: <span class="string">'button-demo-base'</span>,</span><br><span class="line">  &#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>只保留 name, 其他的导入全部去掉。因为现在全部用全局注册的组件了，连同 <code>demo-block</code> 都设置为全局注册了。</p>
<p><img src="/2019/12/26/air-ui-10/1.png" alt="1"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Uncaught <span class="built_in">TypeError</span>: Cannot assign to read only property <span class="string">'exports'</span> <span class="keyword">of</span> object <span class="string">'#&lt;Object&gt;'</span></span><br></pre></td></tr></table></figure>
<p>结果运行界面的时候，直接报错了？？ 后面查了一下 <a href="https://github.com/webpack/webpack/issues/4039" target="_blank" rel="noopener">Cannot assign to read only property ‘exports’ of object ‘#<object>‘ (mix require and export)</object></a></p>
<p>翻译过来就是说，代码没毛病，在<code>webpack</code>打包的时候，可以在<code>js</code>文件中混用<code>require</code>和<code>export</code>。但是不能混用<code>import</code> 以及<code>module.exports</code>,因为<code>webpack 2</code>中不允许混用<code>import</code>和 <code>module.exports</code> , 解决办法就是统一改成ES6的方式编写即可, 全部都用 <code>export default</code>。</p>
<p>而我们刚好在 <code>components/index.js</code> 导出的时候，用了 <code>module.exports</code>，有混用。在 <a href="/2019/12/18/air-ui-8/" title="自建vue组件 air-ui (8) -- 实现部分引入组件">自建vue组件 air-ui (8) -- 实现部分引入组件</a> 有提过。不过那时候我们 <code>air-ui</code> 在打包的时候，其实是没有问题，但是至少可以证明 <code>webpack 3.x</code> 是可以混用的。 所以摆在面前的有两条路：</p>
<ol>
<li>去掉 <code>components/index.js</code> 中 <code>module.exports</code> 语法，全部走 <code>export default</code>, 这样子就不会报错了。这样子 <code>air-ui</code> 的组件就会全部被 <code>vuepress</code> 中的 vue 对象注册成全局组件了。 但是<code>部分导入的语法糖</code>就不能用了(虽然也没啥卵用，因为不能省体积)</li>
<li>保留混用，但是不能用组件库的方式导入，只能单个组件一个一个导入并且引用(好累哦)</li>
</ol>
<p>小孩子才做选择，成年人我全都要。你不觉得<code>部分引入的语法糖</code>很酷吗，干嘛要去掉。所以我选择了第二种(如果是诸位看官，你们还是选第一种吧)，新的代码如下：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> DemoBlock <span class="keyword">from</span> <span class="string">'../../src/components/demo-block'</span></span><br><span class="line"><span class="keyword">import</span> Loading <span class="keyword">from</span> <span class="string">'../../src/components/loading/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Notification <span class="keyword">from</span> <span class="string">'../../src/components/notification/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Button <span class="keyword">from</span> <span class="string">'../../src/components/button/index.js'</span></span><br><span class="line"><span class="keyword">import</span> ButtonGroup <span class="keyword">from</span> <span class="string">'../../src/components/button-group/index.js'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">'../../src/styles/index.scss'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (&#123;</span><br><span class="line">    Vue, <span class="comment">// VuePress 正在使用的 Vue 构造函数</span></span><br><span class="line">  &#125;) =&gt; &#123;</span><br><span class="line">  Vue.component(DemoBlock.name, DemoBlock);</span><br><span class="line">  Vue.component(Button.name, Button);</span><br><span class="line">  Vue.component(ButtonGroup.name, ButtonGroup);</span><br><span class="line">  Vue.use(Loading.directive);</span><br><span class="line">  Vue.prototype.$loading = Loading.service;</span><br><span class="line">  Vue.prototype.$notify = Notification;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这样也是可以的，无非就是手动导入，手动初始化呗。不过这样做的弊端，就是每次我增加一个组件，那么这个文件都要添加这个组件的引用(没办法，要为装逼付出代价!!),但是没事，我后面会写个自动化脚本，来简化这个过程。</p>
<h2 id="写好-notification-的-demo"><a href="#写好-notification-的-demo" class="headerlink" title="写好 notification 的 demo"></a>写好 notification 的 demo</h2><p>既然 <code>enhanceApp.js</code> 写好了，那么就可以安心的写 <code>notification</code> 的 demo， 记得在 <code>config.js</code> 补上对应的组件导航和在 <code>component</code> 目录补上 <code>Notification.md</code>, 然后就可以写 demo 例子了：</p>
<p><img src="/2019/12/26/air-ui-10/2.png" alt="1"></p>
<p>这时候可以看到效果了：</p>
<p><img src="/2019/12/26/air-ui-10/2.gif" alt="1"></p>
<p>完美，现在写组件的 demo，没有那些乱七八糟的引入了，简直不要太方便。</p>
<h2 id="自动化抠组件代码"><a href="#自动化抠组件代码" class="headerlink" title="自动化抠组件代码"></a>自动化抠组件代码</h2><p>虽然写 demo 是爽了，但是写文档还是很不爽，因为我要抄两遍的代码，先写文档，调完之后，然后再把 demo 的一些相关的组件代码，然后再抠出来放到 md 文件。有没有自动化的方式来处理这个过程。 比如以 <code>button/demo-disabled.vue</code> 为例：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;demo-block&gt;</span><br><span class="line">    &lt;air-row&gt;</span><br><span class="line">      &lt;air-button disabled&gt;默认按钮&lt;<span class="regexp">/air-button&gt;</span></span><br><span class="line"><span class="regexp">      &lt;air-button type="primary" disabled&gt;主要按钮&lt;/</span>air-button&gt;</span><br><span class="line">      &lt;air-button type=<span class="string">"success"</span> disabled&gt;成功按钮&lt;<span class="regexp">/air-button&gt;</span></span><br><span class="line"><span class="regexp">      &lt;air-button type="info" disabled&gt;信息按钮&lt;/</span>air-button&gt;</span><br><span class="line">      &lt;air-button type=<span class="string">"warning"</span> disabled&gt;警告按钮&lt;<span class="regexp">/air-button&gt;</span></span><br><span class="line"><span class="regexp">      &lt;air-button type="danger" disabled&gt;危险按钮&lt;/</span>air-button&gt;</span><br><span class="line">    &lt;<span class="regexp">/air-row&gt;</span></span><br><span class="line"><span class="regexp">    &lt;air-row&gt;</span></span><br><span class="line"><span class="regexp">      &lt;air-button plain disabled&gt;朴素按钮&lt;/</span>air-button&gt;</span><br><span class="line">      &lt;air-button type=<span class="string">"primary"</span> plain disabled&gt;主要按钮&lt;<span class="regexp">/air-button&gt;</span></span><br><span class="line"><span class="regexp">      &lt;air-button type="success" plain disabled&gt;成功按钮&lt;/</span>air-button&gt;</span><br><span class="line">      &lt;air-button type=<span class="string">"info"</span> plain disabled&gt;信息按钮&lt;<span class="regexp">/air-button&gt;</span></span><br><span class="line"><span class="regexp">      &lt;air-button type="warning" plain disabled&gt;警告按钮&lt;/</span>air-button&gt;</span><br><span class="line">      &lt;air-button type=<span class="string">"danger"</span> plain disabled&gt;危险按钮&lt;<span class="regexp">/air-button&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>air-row&gt;</span><br><span class="line">  &lt;<span class="regexp">/demo-block&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    name: <span class="string">'button-demo-disabled'</span>,</span><br><span class="line">  &#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>其实要抠出来写到 md 文件的，只有 <code>demo-block</code> 组件里面的内容(<code>air-row</code>是我后面又创建的组件库里面的组件)。 也就是：</p>
<p><img src="/2019/12/26/air-ui-10/3.png" alt="1"></p>
<p>不需要 script 标签， 也不需要 style 标签的内容。但是对于 <code>notification/demo-base.vue</code> 为例:<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">demo-block</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">air-button</span></span></span><br><span class="line"><span class="tag">      <span class="attr">plain</span></span></span><br><span class="line"><span class="tag">      @<span class="attr">click</span>=<span class="string">"open1"</span>&gt;</span></span><br><span class="line">      可自动关闭</span><br><span class="line">    <span class="tag">&lt;/<span class="name">air-button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">air-button</span></span></span><br><span class="line"><span class="tag">      <span class="attr">plain</span></span></span><br><span class="line"><span class="tag">      @<span class="attr">click</span>=<span class="string">"open2"</span>&gt;</span></span><br><span class="line">      不会自动关闭</span><br><span class="line">    <span class="tag">&lt;/<span class="name">air-button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">demo-block</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">    name: <span class="string">'notification-demo-base'</span>,</span></span><br><span class="line"><span class="undefined">    methods: &#123;</span></span><br><span class="line"><span class="undefined">      open1() &#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">const</span> h = <span class="keyword">this</span>.$createElement;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="keyword">this</span>.$notify(&#123;</span></span><br><span class="line"><span class="javascript">          title: <span class="string">'标题名称'</span>,</span></span><br><span class="line"><span class="javascript">          message: h(<span class="string">'i'</span>, &#123; <span class="attr">style</span>: <span class="string">'color: teal'</span>&#125;, <span class="string">'这是提示文案这是提示文案这是提示文案这是提示文案这是提示文案这是提示文案这是提示文案这是提示文案'</span>)</span></span><br><span class="line"><span class="undefined">        &#125;);</span></span><br><span class="line"><span class="undefined">      &#125;,</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">      open2() &#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">this</span>.$notify(&#123;</span></span><br><span class="line"><span class="javascript">          title: <span class="string">'提示'</span>,</span></span><br><span class="line"><span class="javascript">          message: <span class="string">'这是一条不会自动关闭的消息'</span>,</span></span><br><span class="line"><span class="undefined">          duration: 0</span></span><br><span class="line"><span class="undefined">        &#125;);</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>我只要 <code>demo-block</code> 里面的 html，还有就是 script 标签，但是我又不需要 name 属性，因为会误导别人：</p>
<p><img src="/2019/12/26/air-ui-10/4.png" alt="1"></p>
<p>甚至有时候我需要 css 列出来，比如：</p>
<p><img src="/2019/12/26/air-ui-10/5.png" alt="1"></p>
<p>所以我需要写一个自动化的构建脚本，要求以下条件：</p>
<ol>
<li>我只需要根据某些规则，就可以自动引入 demo 例子</li>
<li>并且去读 demo 里面的代码，然后再根据某些规则，判断要把那些代码留下来。</li>
</ol>
<p>后面成品就是，就以 <code>component/Button.md</code> 为例，我只要写:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"># Button 按钮</span><br><span class="line">常用的操作按钮</span><br><span class="line">## 基础用法</span><br><span class="line">基础的按钮用法</span><br><span class="line">:::demo====button-demo-base====使用<span class="string">`type`</span>、<span class="string">`plain`</span>、<span class="string">`round`</span>和<span class="string">`circle`</span>属性来定义 Button 的样式。</span><br><span class="line"></span><br><span class="line">## 禁用状态</span><br><span class="line">按钮不可用状态</span><br><span class="line">:::demo====button-demo-disabled====你可以使用<span class="string">`disabled`</span>属性来定义按钮是否可用，它接受一个<span class="string">`Boolean`</span>值</span><br><span class="line"></span><br><span class="line">## 文字按钮</span><br><span class="line">没有边框和背景色的按钮</span><br><span class="line">:::demo====button-demo-text====</span><br><span class="line"></span><br><span class="line">## 图标按钮</span><br><span class="line">带图标的按钮可增强辨识度（有文字）或节省空间（无文字）</span><br><span class="line">:::demo====button-demo-icon====设置<span class="string">`icon`</span>属性即可，icon 的列表可以参考 Element 的 icon 组件，也可以设置在文字右边的 icon ，只要使用<span class="string">`i`</span>标签即可，可以使用自定义图标。</span><br><span class="line">## 按钮组</span><br><span class="line">以按钮组的方式出现，常用于多项类似操作</span><br><span class="line">:::demo====button-demo-group====使用<span class="string">`&lt;air-button-group&gt;`</span>标签来嵌套你的按钮。</span><br><span class="line">## 加载中</span><br><span class="line">点击按钮后进行数据加载操作，在按钮上显示加载状态。</span><br><span class="line">:::demo====button-demo-loading====要设置为 loading 状态，只要设置<span class="string">`loading`</span>属性为<span class="string">`true`</span>即可。</span><br><span class="line">## 不同尺寸</span><br><span class="line">Button 组件提供除了默认值以外的三种尺寸，可以在不同场景下选择合适的按钮尺寸。</span><br><span class="line">:::demo====button-demo-size====额外的尺寸：<span class="string">`medium`</span>、<span class="string">`small`</span>、<span class="string">`mini`</span>，通过设置<span class="string">`size`</span>属性来配置它们。</span><br><span class="line">## Attributes</span><br><span class="line">| 参数      | 说明    | 类型      | 可选值       | 默认值   |</span><br><span class="line">|---------- |-------- |---------- |-------------  |-------- |</span><br><span class="line">| size     | 尺寸   | string  |   medium / small / mini            |    —     |</span><br><span class="line">| type     | 类型   | string    |   primary / success / warning / danger / info / text |     —    |</span><br><span class="line">| plain     | 是否朴素按钮   | boolean    | — | <span class="literal">false</span>   |</span><br><span class="line">| round     | 是否圆角按钮   | boolean    | — | <span class="literal">false</span>   |</span><br><span class="line">| circle     | 是否圆形按钮   | boolean    | — | <span class="literal">false</span>   |</span><br><span class="line">| loading     | 是否加载中状态   | boolean    | — | <span class="literal">false</span>   |</span><br><span class="line">| disabled  | 是否禁用状态    | boolean   | —   | <span class="literal">false</span>   |</span><br><span class="line">| icon  | 图标类名 | string   |  —  |  —  |</span><br><span class="line">| autofocus  | 是否默认聚焦 | boolean   |  —  |  <span class="literal">false</span>  |</span><br><span class="line">| native-type | 原生 type 属性 | string | button / submit / reset | button |</span><br></pre></td></tr></table></figure></p>
<p>脚本就会把我变成这一串：</p>
<p><img src="/2019/12/26/air-ui-10/3.gif" alt="1"></p>
<p>这个其实是通过一个 gulp 任务来实现的：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 优化文档打包逻辑</span></span><br><span class="line">gulp.task(<span class="string">'doc'</span>, cb =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> gulp.src(<span class="string">'./docs/component_origin/*.md'</span>)</span><br><span class="line">    <span class="comment">// 模版地址修改</span></span><br><span class="line">    .pipe(replace(<span class="regexp">/:::demo====(\w+)-(.+)====(.*)/g</span>, <span class="function"><span class="keyword">function</span> (<span class="params">match, p1, p2, p3</span>) </span>&#123;</span><br><span class="line">      <span class="comment">// console.log("demo:" + match);</span></span><br><span class="line">      <span class="comment">// console.log("p3:" + p3);</span></span><br><span class="line">      <span class="keyword">var</span> str = <span class="string">`</span></span><br><span class="line"><span class="string">&lt;ClientOnly&gt;</span></span><br><span class="line"><span class="string"> &lt;<span class="subst">$&#123;p1&#125;</span>-<span class="subst">$&#123;p2&#125;</span>&gt;&lt;/<span class="subst">$&#123;p1&#125;</span>-<span class="subst">$&#123;p2&#125;</span>&gt;</span></span><br><span class="line"><span class="string">&lt;/ClientOnly&gt;`</span>;</span><br><span class="line">      str += <span class="string">'\n\n'</span>;</span><br><span class="line">      <span class="keyword">if</span> (p3.toString().trim()) &#123;</span><br><span class="line">        str += <span class="string">`::: tip\n<span class="subst">$&#123;p3&#125;</span>\n:::\n\n`</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">var</span> fileName = <span class="string">`docs/.vuepress/components/<span class="subst">$&#123;p1&#125;</span>/<span class="subst">$&#123;p2&#125;</span>.vue`</span>;</span><br><span class="line">      <span class="comment">// 接下来读取这个文件，得到里面的代码</span></span><br><span class="line">      <span class="comment">// return fileName;</span></span><br><span class="line">      <span class="keyword">var</span> fileStr = fs.readFileSync(path.resolve(fileName));</span><br><span class="line">      <span class="comment">// 接下来进行逐行匹配</span></span><br><span class="line">      str += <span class="string">"```vue\n"</span>;</span><br><span class="line">      <span class="keyword">var</span> tplArr = [], cssArr = [], jsArr = [], canAddTpl = <span class="literal">false</span>, canAddCss = <span class="literal">false</span>, canAddJs = <span class="literal">false</span>;</span><br><span class="line">      fileStr.toString().replace(<span class="regexp">/(.+)/g</span>, <span class="function"><span class="keyword">function</span> (<span class="params">match</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// console.log(match);</span></span><br><span class="line">        <span class="keyword">if</span> (match.indexOf(<span class="string">"&lt;/demo-block&gt;"</span>) &gt; <span class="number">-1</span>) &#123;</span><br><span class="line">          canAddTpl = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (canAddTpl &amp;&amp; match.trim()) &#123;</span><br><span class="line">          <span class="comment">// 这边最好再进行两次缩进，即 4 个空格</span></span><br><span class="line">          tplArr.push(match.substring(<span class="number">4</span>, match.length));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (canAddCss &amp;&amp; match.trim()) &#123;</span><br><span class="line">          cssArr.push(match);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 判断是否要忽略一些 js</span></span><br><span class="line">        <span class="keyword">if</span> (match.indexOf(<span class="string">"script--ignore--start"</span>) &gt; <span class="number">-1</span>) &#123;</span><br><span class="line">          canAddJs = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (canAddJs &amp;&amp; match.trim()) &#123;</span><br><span class="line">          jsArr.push(match);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 判断是否要导入 script 的文档</span></span><br><span class="line">        <span class="keyword">if</span> (match.indexOf(<span class="string">"&lt;script doc&gt;"</span>) &gt; <span class="number">-1</span>) &#123;</span><br><span class="line">          canAddJs = <span class="literal">true</span>;</span><br><span class="line">          jsArr.push(<span class="string">"&lt;script&gt;"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (match.indexOf(<span class="string">"script--ignore--end"</span>) &gt; <span class="number">-1</span>) &#123;</span><br><span class="line">          canAddJs = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (match.indexOf(<span class="string">"&lt;demo-block"</span>) &gt; <span class="number">-1</span>) &#123;</span><br><span class="line">          canAddTpl = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (match.indexOf(<span class="string">'&lt;style scoped'</span>) &gt; <span class="number">-1</span>) &#123;</span><br><span class="line">          canAddCss = <span class="literal">true</span>;</span><br><span class="line">          cssArr.push(<span class="string">"&lt;style&gt;"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (match.indexOf(<span class="string">"&lt;/style&gt;"</span>) &gt; <span class="number">-1</span>) &#123;</span><br><span class="line">          canAddCss = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (match.indexOf(<span class="string">"&lt;/script&gt;"</span>) &gt; <span class="number">-1</span>) &#123;</span><br><span class="line">          canAddJs = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="comment">// 最后拼起来</span></span><br><span class="line">      str += tplArr.join(<span class="string">"\n"</span>);</span><br><span class="line">      <span class="keyword">if</span> (jsArr.length) &#123;</span><br><span class="line">        str += <span class="string">"\n\n"</span> + jsArr.join(<span class="string">"\n"</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (cssArr.length) &#123;</span><br><span class="line">        str += <span class="string">"\n\n"</span> + cssArr.join(<span class="string">"\n"</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      str += <span class="string">"\n```"</span>;</span><br><span class="line">      <span class="keyword">return</span> str;</span><br><span class="line">    &#125;))</span><br><span class="line">    .pipe(gulp.dest(<span class="string">'./docs/component'</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>这边我分析一下，主要几个逻辑:</p>
<ol>
<li>获取这个目录<code>./docs/component_origin/*.md</code> 下的所有的所有的 md 文件</li>
<li><p>通过这个规则<code>/:::demo====(\w+)-(.+)====(.*)/</code> 获取 p1 p2 p3 的值，举个例子，假设有一行是这个：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:::demo====button-demo-disabled====你可以使用<span class="string">`disabled`</span>属性来定义按钮是否可用，它接受一个<span class="string">`Boolean`</span>值</span><br></pre></td></tr></table></figure>
<p>那么 p1 就是 <code>button</code>, p2 就是 <code>demo-disabled</code>, p3 就是:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">你可以使用<span class="string">`disabled`</span>属性来定义按钮是否可用，它接受一个<span class="string">`Boolean`</span>值<span class="string">`</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>根据 p1 和 p2 的值，我们就可以嵌入 demo 的语法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">`</span></span><br><span class="line"><span class="string">&lt;ClientOnly&gt;</span></span><br><span class="line"><span class="string"> &lt;<span class="subst">$&#123;p1&#125;</span>-<span class="subst">$&#123;p2&#125;</span>&gt;&lt;/<span class="subst">$&#123;p1&#125;</span>-<span class="subst">$&#123;p2&#125;</span>&gt;</span></span><br><span class="line"><span class="string">&lt;/ClientOnly&gt;`</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>根据 p3 的值，我们就可以嵌入 tip 的语法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (p3.toString().trim()) &#123;</span><br><span class="line">  str += <span class="string">`::: tip\n<span class="subst">$&#123;p3&#125;</span>\n:::\n\n`</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>接下来就是重头戏了，我们要根据 vue demo 里面的规则，从 vue demo 文件里面把对应的代码抠出来</p>
<ol>
<li><p>读取 vue demo 里面的代码，然后一行一行的提取：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fileName = <span class="string">`docs/.vuepress/components/<span class="subst">$&#123;p1&#125;</span>/<span class="subst">$&#123;p2&#125;</span>.vue`</span>;</span><br><span class="line"><span class="comment">// 接下来读取这个文件，得到里面的代码</span></span><br><span class="line"><span class="comment">// return fileName;</span></span><br><span class="line"><span class="keyword">var</span> fileStr = fs.readFileSync(path.resolve(fileName));</span><br></pre></td></tr></table></figure>
</li>
<li><p>提取 <code>&lt;demo-block&gt;...&lt;demo-blcok&gt;</code> 里面的代码</p>
</li>
<li>如果包含 <code>&lt;script doc&gt;</code> 说明接下来要提取 js 代码，如果没有，直接跳过 js 的代码</li>
<li>如果在这过程中，遇到 <code>script--ignore--start</code> 这个标记，说明接下来的 js 代码不提取</li>
<li>如果在这过程中，遇到 <code>&quot;script--ignore--end&quot;</code> 这个标记，说明接下来的 js 代码继续提取</li>
<li>如果接下来遇到 <code>&lt;/script&gt;</code> 这个标签，说明提取 js 代码结束</li>
<li>如果接下来遇到 <code>&lt;style scoped</code> 这个标记，说明接下来要提取 css 代码。如果没有，跳过 css 代码</li>
<li>如果接下来遇到 <code>&lt;/style&gt;</code> 这个标记，说明提取 css 代码结束</li>
</ol>
</li>
<li>最后这几个字符串拼起来就是了。以上面那一句为例，效果就是:</li>
</ol>
<p><img src="/2019/12/26/air-ui-10/6.png" alt="1"></p>
<p>效果非常好，这样子只要 demo 写好了(事先哪些代码要提取，哪些不提取，要先设置好)，那么转换为 md 文档，简直不要太方便了。当然代价就是我们要再建一个 <code>docs/compnent_origin/</code> 目录来写这些未转化后的文档内容：</p>
<p><img src="/2019/12/26/air-ui-10/7.png" alt="1"></p>
<p>举个例子就是，假设 demo 是这样子写的：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;demo-block customClass=<span class="string">"demo-card"</span>&gt;</span><br><span class="line">    &lt;air-row&gt;</span><br><span class="line">      &lt;air-col :span=<span class="string">"8"</span> v-<span class="keyword">for</span>=<span class="string">"(o, index) in 2"</span> :key=<span class="string">"o"</span> :offset=<span class="string">"index &gt; 0 ? 2 : 0"</span>&gt;</span><br><span class="line">        &lt;air-card :body-style=<span class="string">"&#123; padding: '0px' &#125;"</span>&gt;</span><br><span class="line">          &lt;img src=<span class="string">"https://shadow.elemecdn.com/app/element/hamburger.9cf7b091-55e9-11e9-a976-7f4d0b07eef6.png"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"image"</span>&gt;</span><br><span class="line">          &lt;div style=<span class="string">"padding: 14px;"</span>&gt;</span><br><span class="line">            &lt;span&gt;好吃的汉堡&lt;<span class="regexp">/span&gt;</span></span><br><span class="line"><span class="regexp">            &lt;div class="bottom clearfix"&gt;</span></span><br><span class="line"><span class="regexp">              &lt;time class="time"&gt;&#123;&#123; currentDate &#125;&#125;&lt;/</span>time&gt;</span><br><span class="line">              &lt;air-button type=<span class="string">"text"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"button"</span>&gt;操作按钮&lt;<span class="regexp">/air-button&gt;</span></span><br><span class="line"><span class="regexp">            &lt;/</span>div&gt;</span><br><span class="line">          &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>air-card&gt;</span><br><span class="line">      &lt;<span class="regexp">/air-col&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>air-row&gt;</span><br><span class="line">  &lt;<span class="regexp">/demo-block&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script doc&gt;</span><br><span class="line">  <span class="comment">//script--ignore--start</span></span><br><span class="line">  <span class="keyword">import</span> <span class="string">'./card.scss'</span></span><br><span class="line">  <span class="comment">//script--ignore--end</span></span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="comment">//script--ignore--start</span></span><br><span class="line">    name: <span class="string">'card-demo-img'</span>,</span><br><span class="line">    <span class="comment">//script--ignore--end</span></span><br><span class="line">    data() &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        currentDate: <span class="keyword">new</span> <span class="built_in">Date</span>().toLocaleString()</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;style scoped&gt;</span></span><br><span class="line"><span class="regexp">  .time &#123;</span></span><br><span class="line"><span class="regexp">    font-size: 13px;</span></span><br><span class="line"><span class="regexp">    color: #999;</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  .bottom &#123;</span></span><br><span class="line"><span class="regexp">    margin-top: 13px;</span></span><br><span class="line"><span class="regexp">    line-height: 12px;</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  .button &#123;</span></span><br><span class="line"><span class="regexp">    padding: 0;</span></span><br><span class="line"><span class="regexp">    float: right;</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  .image &#123;</span></span><br><span class="line"><span class="regexp">    width: 100%;</span></span><br><span class="line"><span class="regexp">    display: block;</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  .clearfix:before,</span></span><br><span class="line"><span class="regexp">  .clearfix:after &#123;</span></span><br><span class="line"><span class="regexp">    display: table;</span></span><br><span class="line"><span class="regexp">    content: "";</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  .clearfix:after &#123;</span></span><br><span class="line"><span class="regexp">    clear: both</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&lt;/</span>style&gt;</span><br></pre></td></tr></table></figure></p>
<p>那么写成文档的效果就是：</p>
<p><img src="/2019/12/26/air-ui-10/8.png" alt="1"></p>
<p>当然构建要改一下，加上这个任务：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"docs:dev"</span>: <span class="string">"gulp doc &amp;&amp; vuepress dev docs"</span>,</span><br></pre></td></tr></table></figure></p>
<h2 id="vuepress-重写常量-palette-styl"><a href="#vuepress-重写常量-palette-styl" class="headerlink" title="vuepress 重写常量 palette.styl"></a>vuepress 重写常量 palette.styl</h2><p>之前在做 button 的文档的时候，有发现部分例子超出的固定宽度，导致折行了：</p>
<p><img src="/2019/12/26/air-ui-10/9.png" alt="1"></p>
<p>所以看有没有办法将这个 container 容器的宽度变宽一点，看了一下控制台：<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.theme-default-content</span><span class="selector-pseudo">:not(.custom)</span> &#123;</span><br><span class="line">    <span class="attribute">max-width</span>: <span class="number">740px</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">2rem</span> <span class="number">2.5rem</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>发现最大宽度只有 <code>740px</code>, 根本不够用。我们要想办法变宽一点。 其实 <code>vuepress</code> 的主题是可以被导出来(当然只能看，不能覆盖):<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">vuepress</span> <span class="selector-tag">eject</span></span><br></pre></td></tr></table></figure></p>
<p>这时候就会有一个 <code>.vuepress</code> 的目录在执行目录下。点进去就是这个主题的源代码。然后可以从 <code>.vuepress/theme/styles/wrapper.styl</code> 找到这个配置:<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$wrapper</span><br><span class="line">  max-width $contentWidth</span><br><span class="line">  <span class="selector-tag">margin</span> 0 <span class="selector-tag">auto</span></span><br><span class="line">  <span class="selector-tag">padding</span> 2<span class="selector-tag">rem</span> 2<span class="selector-class">.5rem</span></span><br><span class="line">  @<span class="keyword">media</span> (max-width: $MQNarrow)</span><br><span class="line">    padding <span class="number">2rem</span></span><br><span class="line">  @media (max-width: $MQMobileNarrow)</span><br><span class="line">    padding <span class="number">1.5rem</span></span><br></pre></td></tr></table></figure></p>
<p>里面有这个常量表示最大宽度，我们只需要修改这个变量的值就行了。 <code>vuepress</code> 提供了 <code>docs/.vuepress/styles/palette.styl</code> 可以重写一些变量的值，所以我们把这个文件创建起来, 内容是这样子的：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$contentWidth = <span class="number">1000</span>px;</span><br></pre></td></tr></table></figure></p>
<p>这样子宽度就会变大了，重新编译一下，发现变宽了。</p>
<p><img src="/2019/12/26/air-ui-10/10.png" alt="1"></p>
<p>当然你也可以修改其他的变量, 看个人习惯，比如:<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$accentColor =blue<span class="comment">//默认主题颜色</span></span><br><span class="line">$textColor = red<span class="comment">//默认字体颜色</span></span><br><span class="line">$borderColor = #eaecef//默认边框颜色</span><br><span class="line">$codeBgColor = #282c34//默认背景颜色</span><br></pre></td></tr></table></figure></p>
<h2 id="vuepress-更改全局样式"><a href="#vuepress-更改全局样式" class="headerlink" title="vuepress 更改全局样式"></a>vuepress 更改全局样式</h2><p>如果你觉得 <code>vuepress</code> 的默认主题的样式太丑了，其实是可以更改全局样式的，比如原先的 table 样式是这样的：</p>
<p><img src="/2019/12/26/air-ui-10/11.png" alt="1"></p>
<p>我觉得有点丑，我就可以创建这个文件：<code>docs/.vuepress/styles/index.styl</code>， 然后对里面要修改的样式进行重写：<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">tr</span></span><br><span class="line">  <span class="selector-tag">border-top</span> <span class="selector-tag">none</span></span><br><span class="line"><span class="selector-tag">th</span>, <span class="selector-tag">td</span></span><br><span class="line">  <span class="selector-tag">border</span>: <span class="selector-tag">none</span></span><br><span class="line">  <span class="selector-tag">border-bottom</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#dfe2e5</span></span><br></pre></td></tr></table></figure></p>
<p>效果就会比较好看：</p>
<p><img src="/2019/12/26/air-ui-10/12.png" alt="1"></p>
<h2 id="优化-enhanceApp-js"><a href="#优化-enhanceApp-js" class="headerlink" title="优化 enhanceApp.js"></a>优化 enhanceApp.js</h2><p>上面有说过，我们在 <code>enhanceApp.js</code> 采用的是手动导入的方式，这个意味这每次我增加组件，我都得修改这个文件，把新组件的引用加进去，这个有点坑爹，那么有没有不需要的情况。其实是有的，我们其实在写好组件的情况下，会往根目录的 <code>components.json</code> 这个文件加入，用来后面将组件单独打包出来。也就是说，一旦我新增组件的话，那么我就要往这个 <code>components.json</code> 添加这个组件的 name 和 对应的引用路径。 所以后面我们直接读取这个文件，然后脚本生成这些组件的引用，并且初始化，是不是就不需要每次都要修改 <code>enhanceApp.js</code> 这个文件了？</p>
<p>这个自动化脚本也是用 gulp 来生成:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//============= vuepress enhanceApp.js 构建 start ===========</span></span><br><span class="line"><span class="keyword">const</span> Components = <span class="built_in">require</span>(<span class="string">'./components.json'</span>);</span><br><span class="line"><span class="comment">// 有些组件要过滤掉, 包括内置组件和指令组件</span></span><br><span class="line"><span class="keyword">const</span> excludedComponents = [<span class="string">'locale'</span>, <span class="string">'loading'</span>, <span class="string">'message'</span>, <span class="string">'message-box'</span>, <span class="string">'notification'</span>, <span class="string">'infinite-scroll'</span>];</span><br><span class="line"><span class="keyword">let</span> needComponents = [];</span><br><span class="line">gulp.task(<span class="string">'vuepress'</span>, cb =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> gulp.src(<span class="string">'./docs/.vuepress/enhanceApp_origin.js'</span>)</span><br><span class="line">    <span class="comment">// 模版地址修改</span></span><br><span class="line">    .pipe(replace(<span class="regexp">/(.*gulpStart::(.*)::gulpEnd.*)/g</span>, <span class="function"><span class="keyword">function</span> (<span class="params">match, p1, p2</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> str = <span class="string">'//========这中间的代码全部由构建生成====\n'</span>;</span><br><span class="line">      <span class="keyword">if</span> (p2 === <span class="string">'import'</span>) &#123;</span><br><span class="line">        _.each(Components, <span class="function"><span class="keyword">function</span> (<span class="params">path, item</span>) </span>&#123;</span><br><span class="line">          <span class="comment">// console.log("item:" + item);</span></span><br><span class="line">          <span class="keyword">if</span> (_.indexOf(excludedComponents, item) === <span class="number">-1</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> name = upperName(item);</span><br><span class="line">            needComponents.push(name);</span><br><span class="line">            <span class="comment">// 这边取相对路径， 原来都是 ./src 现在换为 ../../src</span></span><br><span class="line">            path = <span class="string">'../.'</span> + path;</span><br><span class="line">            str += <span class="string">`import <span class="subst">$&#123;name&#125;</span> from '<span class="subst">$&#123;path&#125;</span>'\n`</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (p2 === <span class="string">'use'</span>) &#123;</span><br><span class="line">        _.each(needComponents, <span class="function"><span class="keyword">function</span> (<span class="params">item</span>) </span>&#123;</span><br><span class="line">          str += <span class="string">`  Vue.component(<span class="subst">$&#123;item&#125;</span>.name, <span class="subst">$&#123;item&#125;</span>);\n`</span>;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">      str += <span class="string">'//========这中间的代码全部由构建生成====\n'</span>;</span><br><span class="line">      <span class="keyword">return</span> str;</span><br><span class="line">    &#125;))</span><br><span class="line">    .pipe(rename(<span class="string">'enhanceApp.js'</span>))</span><br><span class="line">    .pipe(gulp.dest(<span class="string">'./docs/.vuepress'</span>));</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//============= vuepress enhanceApp.js 构建 end ===========</span></span><br><span class="line">gulp.task(<span class="string">'buildDoc'</span>, [<span class="string">'doc'</span>, <span class="string">'vuepress'</span>]);</span><br></pre></td></tr></table></figure></p>
<p>逻辑其实不难：</p>
<ol>
<li>读取 <code>enhanceApp_origin.js</code>, 一行一行读取</li>
<li>如果有遇到标记的地方，通过读取 action <ol>
<li>如果是 <code>import</code>, 那么就将 <code>components.json</code> 里面的组件都导入</li>
<li>如果是 <code>use</code>, 那么就将 <code>components.json</code> 里面的组件都初始化</li>
<li>中间去掉一些非 标签类型的 组件，这些组件不适用这个模板</li>
</ol>
</li>
</ol>
<p>所以 <code>enhanceApp_origin.js</code> 内容如下：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 扩展 VuePress 应用， 这个 js 的组件是 glup 任务构建的，不要在这个文件里面添加，有修改的话，统一在 enhanceApp_origin.js 这个添加</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">import</span> DemoBlock <span class="keyword">from</span> <span class="string">'../../src/components/demo-block'</span></span><br><span class="line"><span class="keyword">import</span> Loading <span class="keyword">from</span> <span class="string">'../../src/components/loading/index.js'</span></span><br><span class="line"><span class="keyword">import</span> InfiniteScroll <span class="keyword">from</span> <span class="string">'../../src/components/infinite-scroll/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Message <span class="keyword">from</span> <span class="string">'../../src/components/message/index.js'</span></span><br><span class="line"><span class="keyword">import</span> MessageBox <span class="keyword">from</span> <span class="string">'../../src/components/message-box/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Notification <span class="keyword">from</span> <span class="string">'../../src/components/notification/index.js'</span></span><br><span class="line"><span class="comment">//gulpStart::import::gulpEnd</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'../../src/styles/index.scss'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (&#123;</span><br><span class="line">  Vue, <span class="comment">// VuePress 正在使用的 Vue 构造函数</span></span><br><span class="line">&#125;) =&gt; &#123;</span><br><span class="line">  Vue.component(DemoBlock.name, DemoBlock);</span><br><span class="line">  <span class="comment">//gulpStart::use::gulpEnd</span></span><br><span class="line">  <span class="comment">// 接下来处理内置函数</span></span><br><span class="line">  <span class="comment">// loading 这个组件比较特殊，它并不能用 component 的方式来挂载，只能用指令和内置函数的方式</span></span><br><span class="line">  Vue.use(InfiniteScroll);</span><br><span class="line">  Vue.use(Loading.directive);</span><br><span class="line">  <span class="comment">// 以下组件，也需要单独加载，他们也没有标签的方式，只有内置服务的方式</span></span><br><span class="line">  Vue.prototype.$loading = Loading.service;</span><br><span class="line">  Vue.prototype.$message = Message;</span><br><span class="line">  Vue.prototype.$msgbox = MessageBox;</span><br><span class="line">  Vue.prototype.$alert = MessageBox.alert;</span><br><span class="line">  Vue.prototype.$confirm = MessageBox.confirm;</span><br><span class="line">  Vue.prototype.$prompt = MessageBox.prompt;</span><br><span class="line">  Vue.prototype.$notify = Notification;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>打完包之后的 <code>enhanceApp.js</code> 就会变成:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 扩展 VuePress 应用， 这个 js 的组件是 glup 任务构建的，不要在这个文件里面添加，有修改的话，统一在 enhanceApp_origin.js 这个添加</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">import</span> DemoBlock <span class="keyword">from</span> <span class="string">'../../src/components/demo-block'</span></span><br><span class="line"><span class="keyword">import</span> Loading <span class="keyword">from</span> <span class="string">'../../src/components/loading/index.js'</span></span><br><span class="line"><span class="keyword">import</span> InfiniteScroll <span class="keyword">from</span> <span class="string">'../../src/components/infinite-scroll/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Message <span class="keyword">from</span> <span class="string">'../../src/components/message/index.js'</span></span><br><span class="line"><span class="keyword">import</span> MessageBox <span class="keyword">from</span> <span class="string">'../../src/components/message-box/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Notification <span class="keyword">from</span> <span class="string">'../../src/components/notification/index.js'</span></span><br><span class="line"><span class="comment">//========这中间的代码全部由构建生成====</span></span><br><span class="line"><span class="keyword">import</span> Button <span class="keyword">from</span> <span class="string">'../../src/components/button/index.js'</span></span><br><span class="line"><span class="keyword">import</span> ButtonGroup <span class="keyword">from</span> <span class="string">'../../src/components/button-group/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Row <span class="keyword">from</span> <span class="string">'../../src/components/row/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Col <span class="keyword">from</span> <span class="string">'../../src/components/col/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Container <span class="keyword">from</span> <span class="string">'../../src/components/container/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Header <span class="keyword">from</span> <span class="string">'../../src/components/header/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Footer <span class="keyword">from</span> <span class="string">'../../src/components/footer/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Main <span class="keyword">from</span> <span class="string">'../../src/components/main/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Aside <span class="keyword">from</span> <span class="string">'../../src/components/aside/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Checkbox <span class="keyword">from</span> <span class="string">'../../src/components/checkbox/index.js'</span></span><br><span class="line"><span class="keyword">import</span> CheckboxButton <span class="keyword">from</span> <span class="string">'../../src/components/checkbox-button/index.js'</span></span><br><span class="line"><span class="keyword">import</span> CheckboxGroup <span class="keyword">from</span> <span class="string">'../../src/components/checkbox-group/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Link <span class="keyword">from</span> <span class="string">'../../src/components/link/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Radio <span class="keyword">from</span> <span class="string">'../../src/components/radio/index.js'</span></span><br><span class="line"><span class="keyword">import</span> RadioButton <span class="keyword">from</span> <span class="string">'../../src/components/radio-button/index.js'</span></span><br><span class="line"><span class="keyword">import</span> RadioGroup <span class="keyword">from</span> <span class="string">'../../src/components/radio-group/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Input <span class="keyword">from</span> <span class="string">'../../src/components/input/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Select <span class="keyword">from</span> <span class="string">'../../src/components/select/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Option <span class="keyword">from</span> <span class="string">'../../src/components/option/index.js'</span></span><br><span class="line"><span class="keyword">import</span> OptionGroup <span class="keyword">from</span> <span class="string">'../../src/components/option-group/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Tag <span class="keyword">from</span> <span class="string">'../../src/components/tag/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Scrollbar <span class="keyword">from</span> <span class="string">'../../src/components/scrollbar/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Autocomplete <span class="keyword">from</span> <span class="string">'../../src/components/autocomplete/index.js'</span></span><br><span class="line"><span class="keyword">import</span> CollapseTransition <span class="keyword">from</span> <span class="string">'../../src/transitions/collapse-transition'</span></span><br><span class="line"><span class="keyword">import</span> InputNumber <span class="keyword">from</span> <span class="string">'../../src/components/input-number/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Cascader <span class="keyword">from</span> <span class="string">'../../src/components/cascader/index.js'</span></span><br><span class="line"><span class="keyword">import</span> CascaderPanel <span class="keyword">from</span> <span class="string">'../../src/components/cascader-panel/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Switch <span class="keyword">from</span> <span class="string">'../../src/components/switch/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Tooltip <span class="keyword">from</span> <span class="string">'../../src/components/tooltip/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Slider <span class="keyword">from</span> <span class="string">'../../src/components/slider/index.js'</span></span><br><span class="line"><span class="keyword">import</span> DatePicker <span class="keyword">from</span> <span class="string">'../../src/components/date-picker/index.js'</span></span><br><span class="line"><span class="keyword">import</span> TimeSelect <span class="keyword">from</span> <span class="string">'../../src/components/time-select/index.js'</span></span><br><span class="line"><span class="keyword">import</span> TimePicker <span class="keyword">from</span> <span class="string">'../../src/components/time-picker/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Upload <span class="keyword">from</span> <span class="string">'../../src/components/upload/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Progress <span class="keyword">from</span> <span class="string">'../../src/components/progress/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Dialog <span class="keyword">from</span> <span class="string">'../../src/components/dialog/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Form <span class="keyword">from</span> <span class="string">'../../src/components/form/index.js'</span></span><br><span class="line"><span class="keyword">import</span> FormItem <span class="keyword">from</span> <span class="string">'../../src/components/form-item/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Table <span class="keyword">from</span> <span class="string">'../../src/components/table/index.js'</span></span><br><span class="line"><span class="keyword">import</span> TableColumn <span class="keyword">from</span> <span class="string">'../../src/components/table-column/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Popover <span class="keyword">from</span> <span class="string">'../../src/components/popover/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Menu <span class="keyword">from</span> <span class="string">'../../src/components/menu/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Submenu <span class="keyword">from</span> <span class="string">'../../src/components/submenu/index.js'</span></span><br><span class="line"><span class="keyword">import</span> MenuItem <span class="keyword">from</span> <span class="string">'../../src/components/menu-item/index.js'</span></span><br><span class="line"><span class="keyword">import</span> MenuItemGroup <span class="keyword">from</span> <span class="string">'../../src/components/menu-item-group/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Dropdown <span class="keyword">from</span> <span class="string">'../../src/components/dropdown/index.js'</span></span><br><span class="line"><span class="keyword">import</span> DropdownMenu <span class="keyword">from</span> <span class="string">'../../src/components/dropdown-menu/index.js'</span></span><br><span class="line"><span class="keyword">import</span> DropdownItem <span class="keyword">from</span> <span class="string">'../../src/components/dropdown-item/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Rate <span class="keyword">from</span> <span class="string">'../../src/components/rate/index.js'</span></span><br><span class="line"><span class="keyword">import</span> ColorPicker <span class="keyword">from</span> <span class="string">'../../src/components/color-picker/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Transfer <span class="keyword">from</span> <span class="string">'../../src/components/transfer/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Tree <span class="keyword">from</span> <span class="string">'../../src/components/tree/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Pagination <span class="keyword">from</span> <span class="string">'../../src/components/pagination/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Badge <span class="keyword">from</span> <span class="string">'../../src/components/badge/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Avatar <span class="keyword">from</span> <span class="string">'../../src/components/avatar/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Alert <span class="keyword">from</span> <span class="string">'../../src/components/alert/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Tabs <span class="keyword">from</span> <span class="string">'../../src/components/tabs/index.js'</span></span><br><span class="line"><span class="keyword">import</span> TabPane <span class="keyword">from</span> <span class="string">'../../src/components/tab-pane/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Breadcrumb <span class="keyword">from</span> <span class="string">'../../src/components/breadcrumb/index.js'</span></span><br><span class="line"><span class="keyword">import</span> BreadcrumbItem <span class="keyword">from</span> <span class="string">'../../src/components/breadcrumb-item/index.js'</span></span><br><span class="line"><span class="keyword">import</span> PageHeader <span class="keyword">from</span> <span class="string">'../../src/components/page-header/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Steps <span class="keyword">from</span> <span class="string">'../../src/components/steps/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Step <span class="keyword">from</span> <span class="string">'../../src/components/step/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Card <span class="keyword">from</span> <span class="string">'../../src/components/card/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Carousel <span class="keyword">from</span> <span class="string">'../../src/components/carousel/index.js'</span></span><br><span class="line"><span class="keyword">import</span> CarouselItem <span class="keyword">from</span> <span class="string">'../../src/components/carousel-item/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Collapse <span class="keyword">from</span> <span class="string">'../../src/components/collapse/index.js'</span></span><br><span class="line"><span class="keyword">import</span> CollapseItem <span class="keyword">from</span> <span class="string">'../../src/components/collapse-item/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Timeline <span class="keyword">from</span> <span class="string">'../../src/components/timeline/index.js'</span></span><br><span class="line"><span class="keyword">import</span> TimelineItem <span class="keyword">from</span> <span class="string">'../../src/components/timeline-item/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Divider <span class="keyword">from</span> <span class="string">'../../src/components/divider/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Calendar <span class="keyword">from</span> <span class="string">'../../src/components/calendar/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Image <span class="keyword">from</span> <span class="string">'../../src/components/image/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Backtop <span class="keyword">from</span> <span class="string">'../../src/components/backtop/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Icon <span class="keyword">from</span> <span class="string">'../../src/components/icon/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Drawer <span class="keyword">from</span> <span class="string">'../../src/components/drawer/index.js'</span></span><br><span class="line"><span class="comment">//========这中间的代码全部由构建生成====</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">'../../src/styles/index.scss'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (&#123;</span><br><span class="line">  Vue, <span class="comment">// VuePress 正在使用的 Vue 构造函数</span></span><br><span class="line">&#125;) =&gt; &#123;</span><br><span class="line">  Vue.component(DemoBlock.name, DemoBlock);</span><br><span class="line"><span class="comment">//========这中间的代码全部由构建生成====</span></span><br><span class="line">  Vue.component(Button.name, Button);</span><br><span class="line">  Vue.component(ButtonGroup.name, ButtonGroup);</span><br><span class="line">  Vue.component(Row.name, Row);</span><br><span class="line">  Vue.component(Col.name, Col);</span><br><span class="line">  Vue.component(Container.name, Container);</span><br><span class="line">  Vue.component(Header.name, Header);</span><br><span class="line">  Vue.component(Footer.name, Footer);</span><br><span class="line">  Vue.component(Main.name, Main);</span><br><span class="line">  Vue.component(Aside.name, Aside);</span><br><span class="line">  Vue.component(Checkbox.name, Checkbox);</span><br><span class="line">  Vue.component(CheckboxButton.name, CheckboxButton);</span><br><span class="line">  Vue.component(CheckboxGroup.name, CheckboxGroup);</span><br><span class="line">  Vue.component(Link.name, Link);</span><br><span class="line">  Vue.component(Radio.name, Radio);</span><br><span class="line">  Vue.component(RadioButton.name, RadioButton);</span><br><span class="line">  Vue.component(RadioGroup.name, RadioGroup);</span><br><span class="line">  Vue.component(Input.name, Input);</span><br><span class="line">  Vue.component(Select.name, Select);</span><br><span class="line">  Vue.component(Option.name, Option);</span><br><span class="line">  Vue.component(OptionGroup.name, OptionGroup);</span><br><span class="line">  Vue.component(Tag.name, Tag);</span><br><span class="line">  Vue.component(Scrollbar.name, Scrollbar);</span><br><span class="line">  Vue.component(Autocomplete.name, Autocomplete);</span><br><span class="line">  Vue.component(CollapseTransition.name, CollapseTransition);</span><br><span class="line">  Vue.component(InputNumber.name, InputNumber);</span><br><span class="line">  Vue.component(Cascader.name, Cascader);</span><br><span class="line">  Vue.component(CascaderPanel.name, CascaderPanel);</span><br><span class="line">  Vue.component(Switch.name, Switch);</span><br><span class="line">  Vue.component(Tooltip.name, Tooltip);</span><br><span class="line">  Vue.component(Slider.name, Slider);</span><br><span class="line">  Vue.component(DatePicker.name, DatePicker);</span><br><span class="line">  Vue.component(TimeSelect.name, TimeSelect);</span><br><span class="line">  Vue.component(TimePicker.name, TimePicker);</span><br><span class="line">  Vue.component(Upload.name, Upload);</span><br><span class="line">  Vue.component(Progress.name, Progress);</span><br><span class="line">  Vue.component(Dialog.name, Dialog);</span><br><span class="line">  Vue.component(Form.name, Form);</span><br><span class="line">  Vue.component(FormItem.name, FormItem);</span><br><span class="line">  Vue.component(Table.name, Table);</span><br><span class="line">  Vue.component(TableColumn.name, TableColumn);</span><br><span class="line">  Vue.component(Popover.name, Popover);</span><br><span class="line">  Vue.component(Menu.name, Menu);</span><br><span class="line">  Vue.component(Submenu.name, Submenu);</span><br><span class="line">  Vue.component(MenuItem.name, MenuItem);</span><br><span class="line">  Vue.component(MenuItemGroup.name, MenuItemGroup);</span><br><span class="line">  Vue.component(Dropdown.name, Dropdown);</span><br><span class="line">  Vue.component(DropdownMenu.name, DropdownMenu);</span><br><span class="line">  Vue.component(DropdownItem.name, DropdownItem);</span><br><span class="line">  Vue.component(Rate.name, Rate);</span><br><span class="line">  Vue.component(ColorPicker.name, ColorPicker);</span><br><span class="line">  Vue.component(Transfer.name, Transfer);</span><br><span class="line">  Vue.component(Tree.name, Tree);</span><br><span class="line">  Vue.component(Pagination.name, Pagination);</span><br><span class="line">  Vue.component(Badge.name, Badge);</span><br><span class="line">  Vue.component(Avatar.name, Avatar);</span><br><span class="line">  Vue.component(Alert.name, Alert);</span><br><span class="line">  Vue.component(Tabs.name, Tabs);</span><br><span class="line">  Vue.component(TabPane.name, TabPane);</span><br><span class="line">  Vue.component(Breadcrumb.name, Breadcrumb);</span><br><span class="line">  Vue.component(BreadcrumbItem.name, BreadcrumbItem);</span><br><span class="line">  Vue.component(PageHeader.name, PageHeader);</span><br><span class="line">  Vue.component(Steps.name, Steps);</span><br><span class="line">  Vue.component(Step.name, Step);</span><br><span class="line">  Vue.component(Card.name, Card);</span><br><span class="line">  Vue.component(Carousel.name, Carousel);</span><br><span class="line">  Vue.component(CarouselItem.name, CarouselItem);</span><br><span class="line">  Vue.component(Collapse.name, Collapse);</span><br><span class="line">  Vue.component(CollapseItem.name, CollapseItem);</span><br><span class="line">  Vue.component(Timeline.name, Timeline);</span><br><span class="line">  Vue.component(TimelineItem.name, TimelineItem);</span><br><span class="line">  Vue.component(Divider.name, Divider);</span><br><span class="line">  Vue.component(Calendar.name, Calendar);</span><br><span class="line">  Vue.component(Image.name, Image);</span><br><span class="line">  Vue.component(Backtop.name, Backtop);</span><br><span class="line">  Vue.component(Icon.name, Icon);</span><br><span class="line">  Vue.component(Drawer.name, Drawer);</span><br><span class="line"><span class="comment">//========这中间的代码全部由构建生成====</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 接下来处理内置函数</span></span><br><span class="line">  <span class="comment">// loading 这个组件比较特殊，它并不能用 component 的方式来挂载，只能用指令和内置函数的方式</span></span><br><span class="line">  Vue.use(InfiniteScroll);</span><br><span class="line">  Vue.use(Loading.directive);</span><br><span class="line">  <span class="comment">// 以下组件，也需要单独加载，他们也没有标签的方式，只有内置服务的方式</span></span><br><span class="line">  Vue.prototype.$loading = Loading.service;</span><br><span class="line">  Vue.prototype.$message = Message;</span><br><span class="line">  Vue.prototype.$msgbox = MessageBox;</span><br><span class="line">  Vue.prototype.$alert = MessageBox.alert;</span><br><span class="line">  Vue.prototype.$confirm = MessageBox.confirm;</span><br><span class="line">  Vue.prototype.$prompt = MessageBox.prompt;</span><br><span class="line">  Vue.prototype.$notify = Notification;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>当然这种方式只适用于<code>标签组件</code>的组件新增。如果是指令或者服务类型的，还是要手动添加的, 不过要添加到 <code>enhanceApp_origin.js</code> 这个文件，不然一打包又被覆盖了。不过后续的很多标签也都是<code>标签组件</code>。<br>最后的构建指令再改一下：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"docs:dev"</span>: <span class="string">"gulp buildDoc &amp;&amp; vuepress dev docs"</span>,</span><br></pre></td></tr></table></figure></p>
<h2 id="优化-home-vue-的写法"><a href="#优化-home-vue-的写法" class="headerlink" title="优化 home.vue 的写法"></a>优化 home.vue 的写法</h2><p>我们很多的 demo 示例都写在 <code>vuepress</code> 上面了。那就 <code>home.vue</code> 不是没有用了？？ 这个首页后面还是很有用的，因为后面我们在做主题定制的时候，定制一个新主题的时候，在调试的时候，是需要一个页面来显示调试后的效果，这个页面最好包含所有的组件的所有的demo，这样就可以一目了然了。而 <code>home.vue</code> 就扮演这个角色。他就是把所有的组件 demo 都显示到这个页面上，后面好用于主题定制的调试。 假设我们现在还有 <code>button</code> 和 <code>notification</code> 这两个wiki示例。那么 <code>home.vue</code> 就改成：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"wrap"</span>&gt;</span><br><span class="line">    &lt;h1 <span class="class"><span class="keyword">class</span></span>=<span class="string">"warp-title"</span>&gt;&#123;&#123; msg &#125;&#125;&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    &lt;h2&gt;通用组件&lt;/</span>h2&gt;</span><br><span class="line"></span><br><span class="line">    &lt;h4&gt;Button 按钮&lt;<span class="regexp">/h4&gt;</span></span><br><span class="line"><span class="regexp">    &lt;button-demo-base&gt;&lt;/</span>button-demo-base&gt;</span><br><span class="line">    &lt;button-demo-disabled&gt;<span class="xml"><span class="tag">&lt;/<span class="name">button-demo-disabled</span>&gt;</span></span></span><br><span class="line">    &lt;button-demo-group&gt;&lt;/button-demo-group&gt;</span><br><span class="line">    &lt;button-demo-icon&gt;&lt;/button-demo-icon&gt;</span><br><span class="line">    &lt;button-demo-loading&gt;&lt;/button-demo-loading&gt;</span><br><span class="line">    &lt;button-demo-size&gt;&lt;/button-demo-size&gt;</span><br><span class="line">    &lt;button-demo-text&gt;&lt;/button-demo-text&gt;</span><br><span class="line"></span><br><span class="line">    &lt;h2&gt;通知&lt;/h2&gt;</span><br><span class="line">    &lt;h4&gt;Notification 通知&lt;/h4&gt;</span><br><span class="line">    &lt;notification-demo-base&gt;&lt;/notification-demo-base&gt;</span><br><span class="line">    &lt;notification-demo-close&gt;&lt;/notification-demo-close&gt;</span><br><span class="line">    &lt;notification-demo-html&gt;&lt;/notification-demo-html&gt;</span><br><span class="line">    &lt;notification-demo-icon&gt;&lt;/notification-demo-icon&gt;</span><br><span class="line">    &lt;notification-demo-offset&gt;&lt;/notification-demo-offset&gt;</span><br><span class="line">    &lt;notification-demo-position&gt;&lt;/notification-demo-position&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  import ButtonDemoBase from '../../docs/.vuepress/components/button/demo-base'</span><br><span class="line">  import ButtonDemoDisabled from '../../docs/.vuepress/components/button/demo-disabled'</span><br><span class="line">  import ButtonDemoGroup from '../../docs/.vuepress/components/button/demo-group'</span><br><span class="line">  import ButtonDemoIcon from '../../docs/.vuepress/components/button/demo-icon'</span><br><span class="line">  import ButtonDemoLoading from '../../docs/.vuepress/components/button/demo-loading'</span><br><span class="line">  import ButtonDemoSize from '../../docs/.vuepress/components/button/demo-size'</span><br><span class="line">  import ButtonDemoText from '../../docs/.vuepress/components/button/demo-text'</span><br><span class="line">  import NotificationDemoBase from '../../docs/.vuepress/components/notification/demo-base'</span><br><span class="line">  import NotificationDemoClose from '../../docs/.vuepress/components/notification/demo-close'</span><br><span class="line">  import NotificationDemoHtml from '../../docs/.vuepress/components/notification/demo-html'</span><br><span class="line">  import NotificationDemoIcon from '../../docs/.vuepress/components/notification/demo-icon'</span><br><span class="line">  import NotificationDemoOffset from '../../docs/.vuepress/components/notification/demo-offset'</span><br><span class="line">  import NotificationDemoPosition from '../../docs/.vuepress/components/notification/demo-position'</span><br><span class="line"></span><br><span class="line">  export default &#123;</span><br><span class="line">    data () &#123;</span><br><span class="line">      return &#123;</span><br><span class="line">        msg: `AIR-UI  -  基于vue2.x，可复用UI组件`</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    components: &#123;</span><br><span class="line">      [ButtonDemoBase.name]: ButtonDemoBase,</span><br><span class="line">      [ButtonDemoDisabled.name]: ButtonDemoDisabled,</span><br><span class="line">      [ButtonDemoGroup.name]: ButtonDemoGroup,</span><br><span class="line">      [ButtonDemoIcon.name]: ButtonDemoIcon,</span><br><span class="line">      [ButtonDemoLoading.name]: ButtonDemoLoading,</span><br><span class="line">      [ButtonDemoSize.name]: ButtonDemoSize,</span><br><span class="line">      [ButtonDemoText.name]: ButtonDemoText,</span><br><span class="line">      [NotificationDemoBase.name]: NotificationDemoBase,</span><br><span class="line">      [NotificationDemoClose.name]: NotificationDemoClose,</span><br><span class="line">      [NotificationDemoHtml.name]: NotificationDemoHtml,</span><br><span class="line">      [NotificationDemoIcon.name]: NotificationDemoIcon,</span><br><span class="line">      [NotificationDemoOffset.name]: NotificationDemoOffset,</span><br><span class="line">      [NotificationDemoPosition.name]: NotificationDemoPosition,</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line"></span><br><span class="line">    &#125;,</span><br><span class="line">    mounted () &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang="scss"&gt;</span><br><span class="line">  .wrap&#123;</span><br><span class="line">    color: #2c3e50;</span><br><span class="line">    margin: 10px;</span><br><span class="line">    margin-top: 60px;</span><br><span class="line">    .warp-title &#123;</span><br><span class="line">      text-align: center;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  h1,h3&#123;</span><br><span class="line">    margin: 0;</span><br><span class="line">  &#125;</span><br><span class="line">  h3&#123;</span><br><span class="line">    font-weight: normal;</span><br><span class="line">    font-size: 16px;</span><br><span class="line">  &#125;</span><br><span class="line">  h4&#123;</span><br><span class="line">    font-weight: normal;</span><br><span class="line">    font-size: 14px;</span><br><span class="line">    text-align: left;</span><br><span class="line">    background-color: #e9e9e9;</span><br><span class="line">    padding: 10px;</span><br><span class="line">  &#125;</span><br><span class="line">  h2&#123;</span><br><span class="line">    text-align: left;</span><br><span class="line">    width: 100%;</span><br><span class="line">    border-bottom: 1px dashed #ededed;</span><br><span class="line">    font-size: 16px;</span><br><span class="line">    height: 40px;</span><br><span class="line">    line-height: 40px;</span><br><span class="line">    text-indent: 10px;</span><br><span class="line">    margin-top: 30px;</span><br><span class="line">    margin-bottom: 0;</span><br><span class="line">  &#125;</span><br><span class="line">  .demo-block&#123;</span><br><span class="line">    margin-bottom: 10px;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure></p>
<p>还要注意一个细节，因为每一个 demo 都会引用 <code>demo-block</code> 这个组件，所以这个组件要注册为全局，所以要在 <code>main.js</code> 注册一下:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> DemoBlock <span class="keyword">from</span> <span class="string">'./components/demo-block'</span></span><br><span class="line"></span><br><span class="line">Vue.use(DemoBlock)</span><br></pre></td></tr></table></figure></p>
<p>这样就有效果了：</p>
<p><img src="/2019/12/26/air-ui-10/4.gif" alt="1"></p>
<p>跟在 <code>vuepress</code> 文档的表现一样。</p>
<p>不过这边还有一个问题，就是我就两个组件的文档，显示就很长了，而且都是重复性的，有没有可以用自动化脚本再去处理，就跟之前处理 <code>md文件</code> 和<code>enhanceApp.js</code>一样, 还是通过 gulp 来做这个事情：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//============= home vue 构建 start ===========</span></span><br><span class="line"><span class="keyword">var</span> componentsMap = &#123;&#125;;</span><br><span class="line"><span class="keyword">var</span> loadUIComponent = <span class="function"><span class="keyword">function</span> (<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> files = fs.readdirSync(path.resolve(<span class="string">`docs/.vuepress/components/<span class="subst">$&#123;name&#125;</span>`</span>));</span><br><span class="line">  <span class="comment">//遍历读取到的文件列表</span></span><br><span class="line">  files.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">filename</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(filename);</span><br><span class="line">    <span class="comment">// 这边只取 .vue 结尾的文件</span></span><br><span class="line">    <span class="keyword">if</span> (filename.indexOf(<span class="string">".vue"</span>) &gt; <span class="number">-1</span>) &#123;</span><br><span class="line">      componentsMap[name] = componentsMap[name] || [];</span><br><span class="line">      <span class="comment">// 渠道文件名后面的 .vue， 只取前面</span></span><br><span class="line">      componentsMap[name].push(filename.split(<span class="string">"."</span>)[<span class="number">0</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> componentsMap[name];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 优化文档打包逻辑</span></span><br><span class="line">gulp.task(<span class="string">'homeVue'</span>, cb =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> gulp.src(<span class="string">'./src/views/home_origin.vue'</span>)</span><br><span class="line">    <span class="comment">// 模版地址修改</span></span><br><span class="line">    .pipe(replace(<span class="regexp">/(.*gulpStart::(.*)::gulpEnd.*)/g</span>, <span class="function"><span class="keyword">function</span> (<span class="params">match, p1, p2</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> str = <span class="string">''</span>;</span><br><span class="line">      <span class="keyword">if</span> (p2.indexOf(<span class="string">"ui__"</span>) &gt; <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> uiName = p2.split(<span class="string">"__"</span>)[<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">var</span> arr = loadUIComponent(uiName);</span><br><span class="line">        arr = _.map(arr, <span class="function"><span class="keyword">function</span> (<span class="params">item</span>) </span>&#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="string">`    &lt;<span class="subst">$&#123;uiName&#125;</span>-<span class="subst">$&#123;item&#125;</span>&gt;&lt;/<span class="subst">$&#123;uiName&#125;</span>-<span class="subst">$&#123;item&#125;</span>&gt;`</span>;</span><br><span class="line">        &#125;);</span><br><span class="line">        str = arr.join(<span class="string">"\n"</span>);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (p2 === <span class="string">'import'</span>) &#123;</span><br><span class="line">        _.each(componentsMap, <span class="function"><span class="keyword">function</span> (<span class="params">arr, uiName</span>) </span>&#123;</span><br><span class="line">          <span class="comment">// console.log("uiName:" + uiName);</span></span><br><span class="line">          <span class="comment">// console.log("uiArr:" + JSON.stringify(arr));</span></span><br><span class="line">          _.each(arr, <span class="function"><span class="keyword">function</span> (<span class="params">item</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> itemUpperStr = _.map(item.split(<span class="string">"-"</span>), <span class="function"><span class="keyword">function</span> (<span class="params">tmpItem</span>) </span>&#123;</span><br><span class="line">              <span class="comment">// 首字母大写</span></span><br><span class="line">              <span class="keyword">return</span> tmpItem.replace(tmpItem[<span class="number">0</span>], tmpItem[<span class="number">0</span>].toUpperCase());</span><br><span class="line">            &#125;).join(<span class="string">""</span>);</span><br><span class="line">            str += <span class="string">`  import <span class="subst">$&#123;uiName.replace(uiName[<span class="number">0</span>], uiName[<span class="number">0</span>].toUpperCase())&#125;</span><span class="subst">$&#123;itemUpperStr&#125;</span> from '../../docs/.vuepress/components/<span class="subst">$&#123;uiName&#125;</span>/<span class="subst">$&#123;item&#125;</span>'\n`</span>;</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// 去掉最后一个空格</span></span><br><span class="line">        <span class="keyword">var</span> strArr = str.split(<span class="string">"\n"</span>);</span><br><span class="line">        strArr = strArr.splice(<span class="number">0</span>, strArr.length - <span class="number">1</span>);</span><br><span class="line">        str = strArr.join(<span class="string">"\n"</span>);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (p2 === <span class="string">'init'</span>) &#123;</span><br><span class="line">        _.each(componentsMap, <span class="function"><span class="keyword">function</span> (<span class="params">arr, uiName</span>) </span>&#123;</span><br><span class="line">          <span class="comment">// console.log("uiName:" + uiName);</span></span><br><span class="line">          <span class="comment">// console.log("uiArr:" + JSON.stringify(arr));</span></span><br><span class="line">          _.each(arr, <span class="function"><span class="keyword">function</span> (<span class="params">item, index</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> itemUpperStr = _.map(item.split(<span class="string">"-"</span>), <span class="function"><span class="keyword">function</span> (<span class="params">tmpItem</span>) </span>&#123;</span><br><span class="line">              <span class="comment">// 首字母大写</span></span><br><span class="line">              <span class="keyword">return</span> tmpItem.replace(tmpItem[<span class="number">0</span>], tmpItem[<span class="number">0</span>].toUpperCase());</span><br><span class="line">            &#125;).join(<span class="string">""</span>);</span><br><span class="line">            <span class="keyword">var</span> uiModuleName = <span class="string">`<span class="subst">$&#123;uiName.replace(uiName[<span class="number">0</span>], uiName[<span class="number">0</span>].toUpperCase())&#125;</span><span class="subst">$&#123;itemUpperStr&#125;</span>`</span>;</span><br><span class="line">            str += <span class="string">`      [<span class="subst">$&#123;uiModuleName&#125;</span>.name]: <span class="subst">$&#123;uiModuleName&#125;</span>,\n`</span>;</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// 去掉最后一行的逗号, 和最后一行换行</span></span><br><span class="line">        <span class="keyword">var</span> strArr = str.split(<span class="string">"\n"</span>);</span><br><span class="line">        <span class="comment">// 去掉空行</span></span><br><span class="line">        strArr = strArr.splice(<span class="number">0</span>, strArr.length - <span class="number">1</span>);</span><br><span class="line">        str = strArr.join(<span class="string">"\n"</span>);</span><br><span class="line">        <span class="comment">// 去掉逗号</span></span><br><span class="line">        str = str.substring(<span class="number">0</span>, str.length - <span class="number">1</span>);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> str;</span><br><span class="line">    &#125;))</span><br><span class="line">    .pipe(rename(<span class="string">'home.vue'</span>))</span><br><span class="line">    .pipe(gulp.dest(<span class="string">'./src/views'</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>逻辑也不复杂，还是通过读取一个原始的 <code>home_origin.vue</code> 的文件，然后通过构建来生成同目录下的真正的 <code>home.vue</code>,其实跟 <code>enhanceApp.js</code> 任务非常像，也是通过读取不同的 action 操作，然后去写入对应的字符串</p>
<ol>
<li>也是一行一行读取，读取到 p2</li>
<li>如果 p2 ，然后得到 <code>vuepress</code> 组件的目录文档，然后得到这个目录下的 demo 文件的名字，然后如果遇到 <code>import</code> 就导入，如果遇到 <code>init</code> 就初始化。</li>
</ol>
<p>假设 <code>home_origin.vue</code> 的内容是这样子：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"wrap"</span>&gt;</span><br><span class="line">    &lt;h1 <span class="class"><span class="keyword">class</span></span>=<span class="string">"warp-title"</span>&gt;&#123;&#123; msg &#125;&#125;&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    &lt;h2&gt;通用组件&lt;/</span>h2&gt;</span><br><span class="line">    &lt;h4&gt;Button 按钮&lt;<span class="regexp">/h4&gt;</span></span><br><span class="line"><span class="regexp">    &lt;!--gulpStart::ui__button::gulpEnd--&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    &lt;h2&gt;通知&lt;/</span>h2&gt;</span><br><span class="line">    &lt;h4&gt;Notification 通知&lt;<span class="regexp">/h4&gt;</span></span><br><span class="line"><span class="regexp">    &lt;!--gulpStart::ui__notification::gulpEnd--&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>div&gt;</span><br><span class="line">&lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;script&gt;</span></span><br><span class="line"><span class="regexp">  /</span><span class="regexp">/gulpStart::import::gulpEnd</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  export default &#123;</span></span><br><span class="line"><span class="regexp">    data () &#123;</span></span><br><span class="line"><span class="regexp">      return &#123;</span></span><br><span class="line"><span class="regexp">        msg: `AIR-UI  -  基于vue2.x，可复用UI组件`</span></span><br><span class="line"><span class="regexp">      &#125;</span></span><br><span class="line"><span class="regexp">    &#125;,</span></span><br><span class="line"><span class="regexp">    components: &#123;</span></span><br><span class="line"><span class="regexp">      /</span><span class="regexp">/gulpStart::init::gulpEnd</span></span><br><span class="line"><span class="regexp">    &#125;,</span></span><br><span class="line"><span class="regexp">    methods: &#123;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    &#125;,</span></span><br><span class="line"><span class="regexp">    mounted () &#123;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">&lt;/</span>script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=<span class="string">"scss"</span>&gt;</span><br><span class="line">  .wrap&#123;</span><br><span class="line">    color: #2c3e50;</span><br><span class="line">    margin: <span class="number">10</span>px;</span><br><span class="line">    margin-top: <span class="number">60</span>px;</span><br><span class="line">    .warp-title &#123;</span><br><span class="line">      text-align: center;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  h1,h3&#123;</span><br><span class="line">    margin: <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  h3&#123;</span><br><span class="line">    font-weight: normal;</span><br><span class="line">    font-size: <span class="number">16</span>px;</span><br><span class="line">  &#125;</span><br><span class="line">  h4&#123;</span><br><span class="line">    font-weight: normal;</span><br><span class="line">    font-size: <span class="number">14</span>px;</span><br><span class="line">    text-align: left;</span><br><span class="line">    background-color: #e9e9e9;</span><br><span class="line">    padding: <span class="number">10</span>px;</span><br><span class="line">  &#125;</span><br><span class="line">  h2&#123;</span><br><span class="line">    text-align: left;</span><br><span class="line">    width: <span class="number">100</span>%;</span><br><span class="line">    border-bottom: 1px dashed #ededed;</span><br><span class="line">    font-size: <span class="number">16</span>px;</span><br><span class="line">    height: <span class="number">40</span>px;</span><br><span class="line">    line-height: <span class="number">40</span>px;</span><br><span class="line">    text-indent: <span class="number">10</span>px;</span><br><span class="line">    margin-top: <span class="number">30</span>px;</span><br><span class="line">    margin-bottom: <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  .demo-block&#123;</span><br><span class="line">    margin-bottom: <span class="number">10</span>px;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;<span class="regexp">/style&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>那么打出来的 <code>home.vue</code> 就是这样子:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"wrap"</span>&gt;</span><br><span class="line">    &lt;h1 <span class="class"><span class="keyword">class</span></span>=<span class="string">"warp-title"</span>&gt;&#123;&#123; msg &#125;&#125;&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    &lt;h2&gt;通用组件&lt;/</span>h2&gt;</span><br><span class="line">    &lt;h4&gt;Button 按钮&lt;<span class="regexp">/h4&gt;</span></span><br><span class="line"><span class="regexp">    &lt;button-demo-base&gt;&lt;/</span>button-demo-base&gt;</span><br><span class="line">    &lt;button-demo-disabled&gt;<span class="xml"><span class="tag">&lt;/<span class="name">button-demo-disabled</span>&gt;</span></span></span><br><span class="line">    &lt;button-demo-group&gt;&lt;/button-demo-group&gt;</span><br><span class="line">    &lt;button-demo-icon&gt;&lt;/button-demo-icon&gt;</span><br><span class="line">    &lt;button-demo-loading&gt;&lt;/button-demo-loading&gt;</span><br><span class="line">    &lt;button-demo-size&gt;&lt;/button-demo-size&gt;</span><br><span class="line">    &lt;button-demo-text&gt;&lt;/button-demo-text&gt;</span><br><span class="line"></span><br><span class="line">    &lt;h2&gt;通知&lt;/h2&gt;</span><br><span class="line">    &lt;h4&gt;Notification 通知&lt;/h4&gt;</span><br><span class="line">    &lt;notification-demo-base&gt;&lt;/notification-demo-base&gt;</span><br><span class="line">    &lt;notification-demo-close&gt;&lt;/notification-demo-close&gt;</span><br><span class="line">    &lt;notification-demo-html&gt;&lt;/notification-demo-html&gt;</span><br><span class="line">    &lt;notification-demo-icon&gt;&lt;/notification-demo-icon&gt;</span><br><span class="line">    &lt;notification-demo-offset&gt;&lt;/notification-demo-offset&gt;</span><br><span class="line">    &lt;notification-demo-position&gt;&lt;/notification-demo-position&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  import ButtonDemoBase from '../../docs/.vuepress/components/button/demo-base'</span><br><span class="line">  import ButtonDemoDisabled from '../../docs/.vuepress/components/button/demo-disabled'</span><br><span class="line">  import ButtonDemoGroup from '../../docs/.vuepress/components/button/demo-group'</span><br><span class="line">  import ButtonDemoIcon from '../../docs/.vuepress/components/button/demo-icon'</span><br><span class="line">  import ButtonDemoLoading from '../../docs/.vuepress/components/button/demo-loading'</span><br><span class="line">  import ButtonDemoSize from '../../docs/.vuepress/components/button/demo-size'</span><br><span class="line">  import ButtonDemoText from '../../docs/.vuepress/components/button/demo-text'</span><br><span class="line">  import NotificationDemoBase from '../../docs/.vuepress/components/notification/demo-base'</span><br><span class="line">  import NotificationDemoClose from '../../docs/.vuepress/components/notification/demo-close'</span><br><span class="line">  import NotificationDemoHtml from '../../docs/.vuepress/components/notification/demo-html'</span><br><span class="line">  import NotificationDemoIcon from '../../docs/.vuepress/components/notification/demo-icon'</span><br><span class="line">  import NotificationDemoOffset from '../../docs/.vuepress/components/notification/demo-offset'</span><br><span class="line">  import NotificationDemoPosition from '../../docs/.vuepress/components/notification/demo-position'</span><br><span class="line"></span><br><span class="line">  export default &#123;</span><br><span class="line">    data () &#123;</span><br><span class="line">      return &#123;</span><br><span class="line">        msg: `AIR-UI  -  基于vue2.x，可复用UI组件`</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    components: &#123;</span><br><span class="line">      [ButtonDemoBase.name]: ButtonDemoBase,</span><br><span class="line">      [ButtonDemoDisabled.name]: ButtonDemoDisabled,</span><br><span class="line">      [ButtonDemoGroup.name]: ButtonDemoGroup,</span><br><span class="line">      [ButtonDemoIcon.name]: ButtonDemoIcon,</span><br><span class="line">      [ButtonDemoLoading.name]: ButtonDemoLoading,</span><br><span class="line">      [ButtonDemoSize.name]: ButtonDemoSize,</span><br><span class="line">      [ButtonDemoText.name]: ButtonDemoText,</span><br><span class="line">      [NotificationDemoBase.name]: NotificationDemoBase,</span><br><span class="line">      [NotificationDemoClose.name]: NotificationDemoClose,</span><br><span class="line">      [NotificationDemoHtml.name]: NotificationDemoHtml,</span><br><span class="line">      [NotificationDemoIcon.name]: NotificationDemoIcon,</span><br><span class="line">      [NotificationDemoOffset.name]: NotificationDemoOffset,</span><br><span class="line">      [NotificationDemoPosition.name]: NotificationDemoPosition</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line"></span><br><span class="line">    &#125;,</span><br><span class="line">    mounted () &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang="scss"&gt;</span><br><span class="line">  .wrap&#123;</span><br><span class="line">    color: #2c3e50;</span><br><span class="line">    margin: 10px;</span><br><span class="line">    margin-top: 60px;</span><br><span class="line">    .warp-title &#123;</span><br><span class="line">      text-align: center;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  h1,h3&#123;</span><br><span class="line">    margin: 0;</span><br><span class="line">  &#125;</span><br><span class="line">  h3&#123;</span><br><span class="line">    font-weight: normal;</span><br><span class="line">    font-size: 16px;</span><br><span class="line">  &#125;</span><br><span class="line">  h4&#123;</span><br><span class="line">    font-weight: normal;</span><br><span class="line">    font-size: 14px;</span><br><span class="line">    text-align: left;</span><br><span class="line">    background-color: #e9e9e9;</span><br><span class="line">    padding: 10px;</span><br><span class="line">  &#125;</span><br><span class="line">  h2&#123;</span><br><span class="line">    text-align: left;</span><br><span class="line">    width: 100%;</span><br><span class="line">    border-bottom: 1px dashed #ededed;</span><br><span class="line">    font-size: 16px;</span><br><span class="line">    height: 40px;</span><br><span class="line">    line-height: 40px;</span><br><span class="line">    text-indent: 10px;</span><br><span class="line">    margin-top: 30px;</span><br><span class="line">    margin-bottom: 0;</span><br><span class="line">  &#125;</span><br><span class="line">  .demo-block&#123;</span><br><span class="line">    margin-bottom: 10px;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure></p>
<p>是不是非常的方便，所以下次有一个新的组件的 demo 要加进去，那么只需要在模板里面加入：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;h4&gt;Input 输入框&lt;<span class="regexp">/h4&gt;</span></span><br><span class="line"><span class="regexp">&lt;!--gulpStart::ui__input::gulpEnd--&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>那么就会去 <code>docs/.vuepress/components/input</code> 这个目录下找到所有的 demo 文件，并且导入进去。<br>当然最后构建也要变一下：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"start"</span>: <span class="string">"gulp homeVue &amp;&amp; npm run dev"</span>,</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>这边有个细节，因为是用组件的方式来引入 demo 的，所以每一个 demo 都要初始化 name 属性，不然就会出现找不到的情况。这也是为啥之前做 demo 的时候就要设置 name 的原因，就是用在这里。</p>
</blockquote>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>这一节主要是针对 <code>vuepress</code> 这个文档框架的写文档的时候加入了很多更高级的东西，并且为了更省事，还加入了一些 gulp 任务，让开发者可以更方便的写 demo，并且引入 demo 例子。 不过难道你以为 <code>vuepress</code> 就再也没有问题了， no，no，no，还没有讲入坑和爬坑呢，下一节我们讲 vuepress 的爬坑经验。</p>
<hr>
<p>系列文章:<br><a href="/2019/12/01/air-ui-1/" title="自建vue组件 air-ui (1) -- 为啥我要自建一个类 element ui 的组件">自建vue组件 air-ui (1) -- 为啥我要自建一个类 element ui 的组件</a><br><a href="/2019/12/03/air-ui-2/" title="自建vue组件 air-ui (2) -- 先分析一下 element ui 项目">自建vue组件 air-ui (2) -- 先分析一下 element ui 项目</a><br><a href="/2019/12/05/air-ui-3/" title="自建vue组件 air-ui (3) -- css 开发规范">自建vue组件 air-ui (3) -- css 开发规范</a><br><a href="/2019/12/07/air-ui-4/" title="自建vue组件 air-ui (4) -- air-ui 环境搭建和目录结构">自建vue组件 air-ui (4) -- air-ui 环境搭建和目录结构</a><br><a href="/2019/12/09/air-ui-5/" title="自建vue组件 air-ui (5) -- 创建第一个组件 Button">自建vue组件 air-ui (5) -- 创建第一个组件 Button</a><br><a href="/2019/12/12/air-ui-6/" title="自建vue组件 air-ui (6) -- 创建内置服务组件">自建vue组件 air-ui (6) -- 创建内置服务组件</a><br><a href="/2019/12/15/air-ui-7/" title="自建vue组件 air-ui (7) -- 创建指令组件">自建vue组件 air-ui (7) -- 创建指令组件</a><br><a href="/2019/12/18/air-ui-8/" title="自建vue组件 air-ui (8) -- 实现部分引入组件">自建vue组件 air-ui (8) -- 实现部分引入组件</a><br><a href="/2019/12/22/air-ui-9/" title="自建vue组件 air-ui (9) -- 用 vuepress 写文档">自建vue组件 air-ui (9) -- 用 vuepress 写文档</a><br><a href="/2019/12/26/air-ui-10/" title="自建vue组件 air-ui (10) -- vuepress 写文档 (进阶版)">自建vue组件 air-ui (10) -- vuepress 写文档 (进阶版)</a><br><a href="/2020/01/02/air-ui-11/" title="自建vue组件 air-ui (11) -- vuepress 写文档 (爬坑版)">自建vue组件 air-ui (11) -- vuepress 写文档 (爬坑版)</a><br><a href="/2020/01/04/air-ui-12/" title="自建vue组件 air-ui (12) -- 国际化机制">自建vue组件 air-ui (12) -- 国际化机制</a><br><a href="/2020/01/06/air-ui-13/" title="自建vue组件 air-ui (13) -- 国际化机制(进阶版)">自建vue组件 air-ui (13) -- 国际化机制(进阶版)</a><br><a href="/2020/01/09/air-ui-14/" title="自建vue组件 air-ui (14) -- 打包构建(dev 和 dist)">自建vue组件 air-ui (14) -- 打包构建(dev 和 dist)</a><br><a href="/2020/01/11/air-ui-15/" title="自建vue组件 air-ui (15) -- 主题定制">自建vue组件 air-ui (15) -- 主题定制</a><br><a href="/2020/01/13/air-ui-16/" title="自建vue组件 air-ui (16) -- 打包构建 pub 任务">自建vue组件 air-ui (16) -- 打包构建 pub 任务</a><br><a href="/2020/01/16/air-ui-17/" title="自建vue组件 air-ui (17) -- 开发爬坑篇以及总结">自建vue组件 air-ui (17) -- 开发爬坑篇以及总结</a></p>

      
    </div>
    
    
    

    

    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者：</strong>
    Zach Ke
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://kebingzao.com/2019/12/26/air-ui-10/" title="自建vue组件 air-ui (10) -- vuepress 写文档 (进阶版)">http://kebingzao.com/2019/12/26/air-ui-10/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>
    本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！
  </li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/js/" rel="tag"># js</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/12/22/air-ui-9/" rel="next" title="自建vue组件 air-ui (9) -- 用 vuepress 写文档">
                <i class="fa fa-chevron-left"></i> 自建vue组件 air-ui (9) -- 用 vuepress 写文档
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/01/02/air-ui-11/" rel="prev" title="自建vue组件 air-ui (11) -- vuepress 写文档 (爬坑版)">
                自建vue组件 air-ui (11) -- vuepress 写文档 (爬坑版) <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.png"
                alt="Zach Ke" />
            
              <p class="site-author-name" itemprop="name">Zach Ke</p>
              <p class="site-description motion-element" itemprop="description">做最咸的那一条</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">184</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">25</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">46</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/kebingzao" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-globe"></i>GitHub</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#前言"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#内置服务组件的文档怎么写？？"><span class="nav-number">2.</span> <span class="nav-text">内置服务组件的文档怎么写？？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#vuepress-应用级别的配置-enhanceApp-js"><span class="nav-number">3.</span> <span class="nav-text">vuepress 应用级别的配置 enhanceApp.js</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#接入-enhanceApp-js"><span class="nav-number">4.</span> <span class="nav-text">接入 enhanceApp.js</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#写好-notification-的-demo"><span class="nav-number">5.</span> <span class="nav-text">写好 notification 的 demo</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#自动化抠组件代码"><span class="nav-number">6.</span> <span class="nav-text">自动化抠组件代码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#vuepress-重写常量-palette-styl"><span class="nav-number">7.</span> <span class="nav-text">vuepress 重写常量 palette.styl</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#vuepress-更改全局样式"><span class="nav-number">8.</span> <span class="nav-text">vuepress 更改全局样式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#优化-enhanceApp-js"><span class="nav-number">9.</span> <span class="nav-text">优化 enhanceApp.js</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#优化-home-vue-的写法"><span class="nav-number">10.</span> <span class="nav-text">优化 home.vue 的写法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#总结"><span class="nav-number">11.</span> <span class="nav-text">总结</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Zach Ke</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  

    
      <script id="dsq-count-scr" src="https://zach-2.disqus.com/count.js" async></script>
    

    
      <script type="text/javascript">
        var disqus_config = function () {
          this.page.url = 'http://kebingzao.com/2019/12/26/air-ui-10/';
          this.page.identifier = '2019/12/26/air-ui-10/';
          this.page.title = '自建vue组件 air-ui (10) -- vuepress 写文档 (进阶版)';
        };
        var d = document, s = d.createElement('script');
        s.src = 'https://zach-2.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      </script>
    

  




	





  














  




  
  
  
  <link rel="stylesheet" href="/lib/algolia-instant-search/instantsearch.min.css">

  
  
  <script src="/lib/algolia-instant-search/instantsearch.min.js"></script>
  

  <script src="/js/src/algolia-search.js?v=5.1.4"></script>



  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("HIV4XRdKJXB0eaFgtSjiVNaK-gzGzoHsz", "zN3v8grxW0Q8eXwNlEgXxWrF");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  
  

  

  

  

</body>
</html>
